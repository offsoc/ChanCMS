System.register(["./element-plus-legacy.js","./@vue-legacy.js","./index-legacy.js"],function(e,a){"use strict";var l,t,o,r,d,s,n,u,c,i,m,p,f,v,h,g,y,b,_,k,x,w,V,A,I;return{setters:[e=>{l=e.q,t=e.r,o=e.s,r=e.K,d=e.B,s=e.C,n=e.g,u=e.D,c=e.a},e=>{i=e.r,m=e.b,p=e.V,f=e.w,v=e.J,h=e.o,g=e.K,y=e.U,b=e.a2,_=e.a,k=e.M},e=>{x=e.h,w=e.A,V=e._,A=e.t,I=e.a}],execute:function(){var a=document.createElement("style");a.textContent=".icon-list[data-v-557d46a3]{max-height:60vh;overflow-y:auto}.icon-item[data-v-557d46a3]{padding:12px;cursor:pointer;transition:all .3s}.icon-item[data-v-557d46a3]:hover{background-color:var(--el-color-primary-light-9)}.icon-wrapper[data-v-557d46a3]{display:flex;flex-direction:column;align-items:center;gap:8px}.icon[data-v-557d46a3]{width:2em;height:2em}.icon-name[data-v-557d46a3]{font-size:12px;text-align:center;word-break:break-all}.icon-suffix[data-v-557d46a3]{width:1em;height:1em;vertical-align:middle}.icon-suffix-container[data-v-557d46a3]{display:flex;align-items:center;gap:8px;padding-right:8px}.clear-icon[data-v-557d46a3]{cursor:pointer;color:#999;transition:color .2s}.clear-icon[data-v-557d46a3]:hover{color:#666}.selected-icon[data-v-557d46a3]{width:1em;height:1em}\n/*$vite$:1*/",document.head.appendChild(a),e("l",(e={})=>x({url:`${w.BASE_API}/base/role/list`,method:"get",params:e})),e("r",(e={})=>x({url:`${w.BASE_API}/base/role/delete`,method:"get",params:e}));const S={class:"dialog-footer"},B={__name:"dialog",props:{visible:{type:Boolean,default:!1},id:{type:Number,default:0}},emits:["update:visible","success"],setup(e,{emit:a}){const V=e,B=i(null),$=i(null),C=i([]),E=i(0),P=()=>{const e=$.value.getCheckedKeys();C.value=[...e]},U=a,j=m({get:()=>V.visible,set:e=>U("update:visible",e)}),D=p({menus:[],form:{name:"",key:"",sort:"0",status:"1"}});f(()=>V.visible,async e=>{if(e&&(K(),V.id>0)){const e=Number(V.id);E.value=e,O(e),M(e)}});const K=async()=>{try{const e=await((e={})=>x({url:`${w.BASE_API}/base/menu/list`,method:"get",params:e}))();if(200===e.code){const a=A(e.data.list),l=I(a,"title","id");D.menus=l}}catch(e){console.log(e)}},M=async e=>{try{let l=await(a={id:e},x({url:`${w.BASE_API}/base/roleMenu/list`,method:"get",params:a}));if(console.log("res---\x3e",l),200==l.code){let e=l.data.list.map(e=>e.menu_id);C.value=[...e]}}catch(l){console.error(l)}var a},z=async()=>{try{const e=await((e={})=>x({url:`${w.BASE_API}/base/role/create`,method:"post",data:e}))({roleData:D.form,menuIds:C.value});200===e.code?(c({message:"创建成功 ^_^",type:"success"}),R()):c({message:e.msg,type:"error"})}catch(e){console.log(e)}},N=async()=>{try{let e={roleId:E.value,roleData:D.form,menuIds:C.value};const a=await((e={})=>x({url:`${w.BASE_API}/base/role/update`,method:"post",data:e}))(e);200===a.code?(c({message:"更新成功 ^_^",type:"success"}),R()):c({message:a.msg,type:"error"})}catch(e){console.log(e)}},O=async e=>{try{let a=await((e={})=>x({url:`${w.BASE_API}/base/role/detail`,method:"get",params:e}))({id:e});200==a.code&&(D.form=a.data)}catch(a){console.error(a)}},R=()=>{U("update:visible",!1),q()},q=()=>{D.form={name:"",key:"",sort:"0",status:"1"},D.menus=[],E.value=0,C.value=[]};return(e,a)=>{const c=o,i=t,m=r,p=s,f=d,x=l,w=n,V=u;return h(),v(V,{modelValue:j.value,"onUpdate:modelValue":a[5]||(a[5]=e=>j.value=e),title:"编辑",onClose:R},{footer:g(()=>[_("span",S,[y(w,{onClick:k(R,["stop"])},{default:g(()=>[...a[8]||(a[8]=[b("取消",-1)])]),_:1}),y(w,{type:"primary",onClick:a[4]||(a[4]=e=>(e=>{e&&e.validate(e=>{if(!e)return console.log("error submit!!"),!1;0==E.value?z():N()})})(B.value))},{default:g(()=>[...a[9]||(a[9]=[b("确定",-1)])]),_:1})])]),default:g(()=>[y(x,{model:D.form,ref_key:"formRef",ref:B,"label-width":"84px"},{default:g(()=>[y(i,{label:"角色名称",prop:"name"},{default:g(()=>[y(c,{modelValue:D.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>D.form.name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),y(i,{label:"角色标识",prop:"key"},{default:g(()=>[y(c,{modelValue:D.form.key,"onUpdate:modelValue":a[1]||(a[1]=e=>D.form.key=e),placeholder:"请输入角色标识"},null,8,["modelValue"])]),_:1}),y(i,{label:"角色顺序",prop:"sort"},{default:g(()=>[y(c,{modelValue:D.form.sort,"onUpdate:modelValue":a[2]||(a[2]=e=>D.form.sort=e),type:"number",placeholder:"请输入角色顺序"},null,8,["modelValue"])]),_:1}),y(i,{label:"权限菜单",prop:"pid"},{default:g(()=>[y(m,{onCheck:P,data:D.menus,"default-checked-keys":C.value,multiple:"",ref_key:"treeRef",ref:$,"render-after-expand":!1,"show-checkbox":"","check-on-click-node":"","show-count":!0,"node-key":"id",class:"w-full"},null,8,["data","default-checked-keys"])]),_:1}),y(i,{label:"状态"},{default:g(()=>[y(f,{modelValue:D.form.status,"onUpdate:modelValue":a[3]||(a[3]=e=>D.form.status=e)},{default:g(()=>[y(p,{label:"显示",value:"1"},{default:g(()=>[...a[6]||(a[6]=[b("正常",-1)])]),_:1}),y(p,{label:"隐藏",value:"2"},{default:g(()=>[...a[7]||(a[7]=[b("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},$=e("D",V(B,[["__scopeId","data-v-557d46a3"]])),C=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));e("d",C)}}});
